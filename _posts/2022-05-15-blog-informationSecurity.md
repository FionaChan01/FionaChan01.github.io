---
title: 'FiFi‘s School Work: Information Security Foundation'
date: 2022-05-15
permalink: /posts/2022/05/blog-post-InformationSecurityFoundation/
tags:
  - CS
  - Knowledge
---

重庆大学计算机学院 ｜ 22Spring ｜ 信息安全基础

## Chap1 信息安全基本概念

- 信息的概念

	- 对比
		- “信息”不同于消息：消息是表现形式，**信息是实质**
		- “信息”不同于情报：**情报含义比”信息”窄**，是一类特殊的信息
		- “信息不同于知识”：**知识是有价值的信息**，是一种高层次的信息

	- 香农：信息是用来消除随机不定性的东西
	- 信息熵：信息的不确定性度量

- 信息技术

	> 概念：能扩展人处理信息功能的技术

	- 类别：感知技术/ 通信技术/ 计算技术
	- 阶段：C1S11
	- 发展趋势：C1S12

- 信息安全

	- 概念
		- **从信息本身的角度**：保障信息不被未经授权使用（破坏）
		- **从信息技术的角度**：保障信息被正确地处理（创建、输入、存储、输出、传输、计算、销毁）
		- **从应用场景的角度**：计算机安全、网络安全、信息系统安全、网络空间安全等概 念，**本质上是在这些场景下确保信息和处理信息的安全**

	- 威胁分类

		- 实体安全
			- **作用点：**对计算机网络与计算机系统的物理装备的威胁，主要表现在自然灾害、电磁辐射与恶劣工作环境方面。
			- **外显行为：**通信干扰，危害信息注入，信号辐射，信号替换，恶劣操作环境。
			- **防范措施：**抗干扰系统，防辐射系统，隐身系统，加固系统，数据备份。
		- 网络安全
			- **作用点：**对计算机网络与计算机系统可用性与可控性进行攻击。
			- **外显行为：**网络被阻塞，黑客行为，非法使用资源等，计算机病毒，使得依赖于信息系统的管理或控制体系陷于瘫痪。
			- **防范措施：**防止入侵，检测入侵，攻击反应，系统恢复。
		- 系统安全
			- **作用点：**对各种系统的使用进行的攻击威胁，主要表现在操作系统、数据库、Web系统、电子商务等应用系统等的攻击威胁。
			- **外显行为：**冒充合法用户，篡改密码，信息抵赖。
			- **防范措施：**加密身份认证技术，系统加固技术，安全交易协议。
		- 数据安全（信息安全）
			- **作用点：**对所处理的信息机密性与完整性的威胁，主要体现在加解密、防篡改、数字产品产权等方面。
			- **外显行为：**窃取信息，篡改信息，冒充信息，信息抵赖。
			- **防范措施：**加解密，完整性技术，数字签名，数字水印。
		- 内容安全
			- **作用点：**有害信息的传播对我国的政治制度及传统文化的威胁，垃圾信息对人们日常生活的干扰。
			- **外显行为：**淫秽暴力信息泛滥、敌对的意识形态信息涌入、英语文化的“泛洪现象”对民族文化的冲击，垃圾信息泛滥。
			- **防范措施：**监测、控管、信息过滤、隐私保护，法律法规

	- 应用场景

		- 网络安全

		- 安全攻击

			- 被动攻击：试图了解或利用系统的信息但不影响系统资源 -> 窃听、检测：消息内容的泄露、流量分析

				<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/1.png"/>

			- 主动攻击：试图改变系统资源或影响系统运作 -> 对数据流进行修改、伪造数据流

				- 伪装：指某实体假装别的实体
				- 重播：指将获得的消息再次发送以产生非授权的效果
				- 消息修改：指修改合法消息的一部分或延迟消息的传输或改变消息的顺序以获得非授权的效果
				- 拒绝服务：阻止或禁止对通信设施的正常使用或管理

				<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/2.png"/>

		- 常见攻击：C1S27

- 多角度理解信息安全

	- CIA安全需求模型：C1S29
		- 保密性：确保信息资源仅被合法的实体访问-> 信息加密，划分等级分配权限
		- 完整性：信息资源只能以授权方式修改、操作系统的逻辑正确性和可靠性 -> 预防：阻止任何未经授权的改写、检测：发现数据完整性是否遭受破坏
		- 可用性：信息资源可被合法用户访问并按要求的特性使用而不遭拒绝服务 -> 备份与灾难恢复、应急响应、系统容侵
		- 更多需求：C1S34 不可抵赖性、可认证性、可控性、可审查性、可存活性

- 研究的内容 C1S38

- 基本观点

	- 没有一种类型的安全技术、产品能全面保护计算机的安全
	- 安全的强度由安全性最弱的要素来决定
	- 不存在绝对的安全 -> 安全性和可用性、成本投入间的平衡

# Chap3 数据安全--信息加密

- 密码学

	- 发展的几个阶段 C3S3

		- 古典密码学阶段：保密性基于方法（替代、置换），采用手工或初级电子设备方式加解密
		- 密码学形成阶段：保密性基于密钥，采用电子计算机实现加解密
		- 公钥密码体制阶段
		- 量子密码学产生阶段：P=NP时不安全

	- 一般的数据加密模型：公开信道保密通信，要保障传输的信息内容不被第三方获得

	- 组成

		- 明文$m_i$和明文空间$M$

			- 明文是易于理解的信息，对计算机而言是数字化的信息，可以背存储、传输、加工

			- 明文空间：$ M={m=(m1,m2,…,ml)|mi∈X, 1≤ i≤ l }$

				   明文长度为l

				   X称为明文字母表

		- 密文$C_i$和密文空间$C

			- 密文：不易被理解的信息

			- 密文空间：$C={c=(c1,c2.,…,ct)| ci∈Y, 1≤ i≤ t }$

				​    密文长度为t

				​    Y称为密文字母表

		- 密钥空间$K={(Ke,Kd)}$

			- 密钥：加密算法E、解密算法D的运行控制参数

			- 密钥空间：$K={k=(k1,k2,…,ks)| ki∈B, 1≤ i≤ s }$

				​    密钥长度为s

				​    B称为密钥源字母表

		- 加密算法E
			- 本质上是M到C的映射，由$K_e$控制
			- 加密:$c=E_{ke}(m)$
		- 解密算法D
			- 本质上是C到M的映射，由$K_d$控制
			- 解密:$m=D_{kd}(c)=D_{kd}(E_{ke}(m))$

	- 密保系统的分类

		- 按保密内容 C3S12
			- 受限制的算法：基于算法的秘密
			- 基于密钥的算法：基于对密钥的保密
		- 按密钥数量来分 C3S13
			- 对称密码算法：$K_d=K_e$，或其之间存在某种易于发现的关系
				- 最大的问题：ke需要在加密、解密方间交换，密钥的传输、分配是最大问题
			- 非对称密码算法$K_d≠K_e$，或其之间不存在某种易于发现的关系
				- $K_e$不需要保密，可以公开，$K_d$需要保密
		- 按照明文处理方式 C3S14
			- 分组密码：将明文分成固定长度的组，用同一密钥和算法对每一块进行加密，输出也是固定长度的密文
			- 流密码：序列密码一次加密一位、一字节的明文

	- 密码系统的安全性 C3S15

		- 密文出现的概率
		- 完善保密系统的含义 $ I(M;C)=H(M)-H(M|C)=0$，则称相应的密码系统为完善保密系统。知道密文，也不能获取更多明文的信息
		- 密码系统设计的基本原则：确保明文与密文间的互信息为0
		- 完善保密系统的必要条件：$H(K)≥ H(M)$, M和C要完全无关，密钥熵不能小于明文熵,密钥必须具有随机特性，即K应为真正的随机序列
		- 分类
			- 无条件安全  C3S18：无论破译者有多少密文，也无法解出对应的明文 -> 一次性密码，满足H(K) ≥H(M)条件，但大多数场景不适用
			- 计算上安全 C3S19: 破译的代价超出信息本身的价值，时间超出信息的有效期，破译的时间复杂度不是多项式的
		- 研究
			- 密码学
			- 密码编码学
			- 密码分析学（未知密钥）

- 古典密码

	- 塞塔式密码

	- 置换密码

		> 根据一定规则重新安排明文，使其失去可理解特性

		- 缺点：不能抗攻击，甚至是唯密文攻击

	- 替代密码

		> 将明文空间中的一个字符或字符串替换成密文空间中的一个字符或字符串

		- 单表替代密码

			> 一个明文字母对应一个密文字母

			- 形式：$c=E(m)=(am+b)  mod n $(仿射密码)
			- 缺点：不能抗穷举攻击、统计攻击（明文的字母统计特性反映在密文中）

		- 同音替代密码

			> 一个明文字母对应多个密文字母

		- 多表替代密码

			> 由多个单表替代密码构成，一个字母在不同位置被替换成不同的密文字母

			- t个密文本（ t=1为单表替代），加密为：$ci=fi(mi)=(mi+ki) mod 26$,其中ki为密钥,i=0,1,…,t-1

		- 多字母替代密码

	- 一次一密方案

		- 含义：
			- 密钥是真正的随机序列
			- 密钥长度至少等于明文长度
			- 一个密钥只用一次
		- 评价：满足上述三个条件的密码系统是绝对安全的
		- Verman密码：利用异或加密；多表替代密码
		- 问题：密钥如何产生、分配

	- 密码机--轮转机

		- 实质：长周期的多表替代密码

- 现代密码技术 C3S37

	- 序列密码（流密码）

		<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/seq.png"/>

		- 密钥序列：需保证随机性
		- 伪随机序列的产生方法：利用反馈移位寄存器来产生伪随机序列

	- 分组密码（块密码）

		- 数字输入序列被划分为长度为n的；密文块为t
		- 一般有t=n，若t>n：有数据扩散的分组密码, t<n：有数据压缩的分组密码
		- 设计原则：足够大的分组长度（否则可穷举明文空间来攻击），密钥空间尽可能大（都则可穷举密钥空间），算法复杂度足够强
		- 基本加密方法
			- 混乱 -> 非线形替代
			- 扩散 -> 明文中的每一位可以影响密文中的许多位，达到雪崩效应
		- Feistel网络
			- 明文分组为$L_0$,$R_0$，通过n次循环处理后，再结合起来生成密文分组
			- 每次循环都以上一次循环产生的$L_{i-1}$,$R_{i-1}$和K产生的子密钥$K_i$作为输入
			- 具体加密解密过程 C3S45
		- DES加密算法
			- 加密过程 C3S48
				- IP置换
				- 16轮变换
					- 选择扩展运算E
					- 选择压缩运算S（DES算法的关键所在，只有该盒是非线性运算，且不易与分析，安全性高）：8个S盒，每盒6位，输出4位 -> 具体构造原则C3S57
					- 置换运算P：目的在于提供雪崩效应（明文或密钥一点小的变动就会引起密文的较大变化）
				- 子密钥的生成
			- 密钥置换算法的构造准则
				- 设计目标是子密钥的统计独立性和灵活性，还需实现简单、速度、不存在简单关系
		- 电子密码本ECB C3S64
			- 特点：简单有效，可并行实现；但不能隐藏明文的模式信息，对明文的主动攻击是有可能的-> 误差传递，适合于传输短信息
		- 密码分组链接CBC C3S66
			- 特点：没有已知的并行实现算法，但能够隐藏明文的模式信息，对明文的主动攻击是不容易的，比ECB安全性好，适合于传输长度大于64位的报文
		- 密码反馈CFB C3S67
			- 特点：分组密码->流密码，没有已知的并行实现算法，需要共同的移位寄存器初始值
		- OFB C3S70
			- 特点：安全性较CFB差
		- 其他分组密码：IDEA、AES C3S75

	- 公钥密码体制（不是无条件安全的）

		- 基本思想

			$ke≠ kd$(ke可公开，kd不行)

		- 基本条件

			- 加密变换和解密变换在计算上是容易的，即其复杂性属于P问题求解的复杂性
			- 密码分析在计算上是困难的，即其复杂性属于NP完全性问题的复杂性

		- 算法条件

			- 产生一对密钥是计算可行的
			- 已知公钥、明文，产生密文是计算可行的
			- 利用私钥、密文，得到明文是计算可行的
			- 利用公钥来推断私钥是计算不可行的
			- 利用公钥、密文，得到明文是计算不可行的
			- 加密和解密的顺序可交换(可选条件)

		- 单向陷门函数

			- 单向函数 eg：$y =a^x $
			- 单向陷门函数（f，t为f相关参数），陷门可作为公钥密码系统的私钥，设计公钥密码体制就在于寻找理想的单向陷门函数
				-  给定x,计算y,使y=f(x)是很容易的
				- 给定y,计算x
					- 当t已知时，计算x=f-1(y) 是很容易的；
					- 当t未知时，计算x=f-1(y) 是很难的

		- RSA算法

			> 公开密钥：(e,n)，保密密钥(d),d、e是可互换的

			> DES算法：
			>
			> 优点：密钥较短，加密处理简单，加解密速度快，适用于加密大量数据的场合。
			>
			> 缺点：密钥单一，不能由其中一个密钥推导出另一个密钥。
			>
			> RSA算法：
			>
			> 优点：应用广泛，加密密钥和解密密钥不一样，一般加密密钥称为私钥。解密密钥称为公钥，私钥加密后只能用公钥解密,，当然也可以用公钥加密，用私钥解密。
			>
			> 缺点：密钥尺寸大，加解密速度慢，一般用来加密少量数据，比如DES的密钥

			- 选取两个大素数p和q（保密）

			- 计算n=pq(公开)，Φ(n)=(p-1)(q-1)
			- 随机选取正整数e（(1<e<Φ(n)），满足gcd(e, Φ(n))=1；e为公开的加密密钥（e、Φ(n)互素），GCD指大公约数
			- 计算d，满足d*e≡ 1(mod Φ(n))（e对于Φ(n) 的模反元素,  d为保密的解密密钥,d与n也是互素的

			<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/rsa.png"/>

# Chap4 消息鉴别

> 消息鉴别：证实收到的消息来自可信信源且消息未被篡改的过程
>
> 目的：验证消息源的真实性 & 验证消息的完整性

> - 先校验，再加密
>
> 	- 加密前给明文拼加校验值，加密时，一起加密
>
> 	- 解密后，检查校验值是否一致

#### 1. 基于消息鉴别码的鉴别方法

- 基本思想
	- 发送方A生成$MAC = F(M,K)$，k为密钥，F为鉴别码生成函数
		- 函数特性：为多对一映射，若M相同，存在多个Key产生相同的MAC，若Key相同，多个M产生相同的MAC
	- 将明文M加上MAC传输
	- 接收方生成$MAC' = F(M',K)$，比较MAC‘==MAC
- MAC作用
	- 如果接收方发现MAC匹配，可以确定报文M的完整性（攻击者不知道密钥k，因此不可能计算出一个更改后报文相对应的MAC值）
	- 接收方B也能够确信报文M的真实性（来自发送者A，因为只有A了解密钥K）
	- ⚠️ 但是不能有效防止重放攻击、接收者伪造攻击
- MAC函数与加解密函数比较
	- 相似且都需要密钥
	- MAC函数可以是单向函数，加解密函数需要可逆
	- MAC算法不能提供信息的保密性，保密性可以通过对消息加密来提供
	- 基于MAC的消息鉴别方式、鉴别过程独立于加密、解密过程
	- MAC方式更适合不需要加密保护的数据的鉴别（某些应用中，鉴别真实性比报文的保密性更重要）
- 基于MAC的鉴别方法
	- 基于**消息加密**的MAC生成鉴别方法
		- 不足之处：传输量大（MAC实际传输的数据是明文大小的2倍）；不能防止重放攻击、接收方伪造攻击
	- 基于单向Hash函数和**对称密钥体制**的MAC生成鉴别方法
		- 不足之处：不能防止重放攻击、接收方伪造攻击
	- 基于单向Hash函数和**公钥密码体制**的MAC生成鉴别方法
		- 能防止接收方伪造攻击，不能防止重放攻击
	- 基于**秘密数据块**和单项Hash函数的MAC生成鉴别方法（用于SNMP2协议中）
		- 不足之处：不能防止重放攻击、接收方伪造攻击
- 对MAC强行攻击的难度
	- 验证需要进行多个轮次，直至最后产生一个唯一的密钥
		- 第一轮：选择M1和MAC1，对所有$2^k$个key计算，得到的匹配的密钥数量约等于$2^{k-m}$
		- 第二轮：选择M2和MAC2，对所有$2^{k-m}$个key计算，得到的匹配的密钥数量约等于$2^{k-2m}$
		- ....
		- 进行大约k/m轮
	- 攻击的计算量约为：$2^k+2^{k-m}+2^{k-2m}+......$，可见对于MAC函数强行攻击的难度大于对密码的攻击的难度
- MAC函数设计要点
	- 如果攻击者得到一个M及对应的MAC，则试图构造一个消息M‘使得MAC’=MAC在计算上应该是不可行的
	- MAC函数应该是均匀分布的，即随机选择消息 M 和 M’，MAC = MAC’ 的概率应是 $2^{-m}$，其中 m 是 MAC 的位数
	- 令 M’ 为 M 的某些已知变换，即：M’ = *f* (M)，应保证在这种情况下，MAC = MAC’ 的概率为 $2^{-m}$

#### 2. 单向散列函数 

> $h=H(M)$

- 函数参数

	输入为任意长度，输出必须固定长度

- 函数性质

	> 碰撞则意味着容易伪造，欺骗

	- 单向性质：给定M，容易计算出h；但给定h和H，要找m使H(m)=h时困难的，求逆很困难
	- 弱抗碰撞特性：弱无碰撞，对给定的y，找x，使得H(x)=H(y)是困难的
	- 强抗碰撞特性（生日攻击）：强无碰撞，找x和y，使得H(x)=H(y)是困难的，即发现一个碰撞很难

- 生日攻击：找x和y满足H(x)=H(y),需尝试多少个报文(长度最长为n)？

	- 显然，最多尝试2n＋1个报文，必有一对冲突

- 生日悖论：一群人中，至少有两个人生日相同的概率有多少

	<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/bd.png"/>

	- k为何值可以使人群中至少存在两个人生日相同的概率大于50% -> 23人

- 单向散列函数常用设计方法

	- 将消息m分成k组
	- 对每个分组逐一处理，输入是当前分组和上一分组的处理结果 $h_i = H(m_i,h_{i-1})$
	- 最后一个分组处理结果$h_k$是整个消息的散列值

- 常用的单向散列函数 C4S22

	- MD5

		> 不是强无碰撞的，在法律意义上不安全

		- 输入：任意长度的消息M
		- 输出：定长为128位的消息散列值
		- 算法：
			- 填充比特位：先附加一位1，然后附加多位0，直到L≡448(mod 512）（如果在填充前已经满足L≡448(mod 512)， 则在消息后附加1位1和511位0）
			- 附加消息长度：在第一步基础上再附加64位的消息长度信息（进行步骤1前消息的长度）
			- 初始化寄存器：4个32位寄存器
			- 计算散列值（核心）：64次变换，每次变换参数不同，函数形式相同
			- 散列值输出

# Chap5.1 数据安全--数字签名

#### 1. 数字签名概述

- 如何保证合同的真实特性？

	- 现实中：人们采用手写签名的形式

		- 特性：不可伪造、不可重用、不可改变、不可抵赖、可仲裁

	- 真实性内涵

		>    加密不能提供者这种特性，主要防止信息被非法使用
		>
		>    消息摘要也不能提供这种特性，主要防止信息被篡改      

		- 信源与信宿真实
		- 内容真实
		- 双方都不能抵赖

- 数字签名和消息认证的区别

	| 数字签名                         | 消息鉴别                         |
	| -------------------------------- | -------------------------------- |
	| 有利害冲突，必须使用数字签名技术 | 有利害冲突，防止第三方破坏       |
	| 能确定消息来源的真实性           | 能够验证消息发送者身份是否被篡改 |
	| 能保证实体身份的真实性           | 能够验证所发消息内容是否被篡改   |
	| 数字签名是不可否认的             |                                  |

- 数字签名的设计目标

	- 签名的比特模式依赖于消息报文，签名能对消息的内容进行鉴别
	- 数字签名对发送者来说是唯一的
	- 算法必须相对简单易于实现、能够在存储介质上保存备份
	- 对签名的识别、证实、鉴别也必须相对简单易于实现
	- 伪造签名在计算上不可行

- 数字签名的特性

	- 不可伪造性
	- 可信性
	- 不可更改性
	- 不可重用性
	- 抗抵赖性

#### 2. 数字签名主要算法

> Hash、DSS、RSA、ELGamal

- 基于公钥体制RSA的数字签名

	> 发送者S，接受者R

	- 加密
		- 发送用R的公钥加密
		- 接收用R的私钥解密
	- 签名
		- 用S的私钥签名（加密
		- 用S的公钥验证（解密
	- 特点
		- 签名不可伪造、不可重用 -> S用私钥签名，具有唯一性
		- 发送方S不能否认发送过签名的文件 -> S的公钥是公开的，任何人可以验证签名的有效性
		- 收方R不能篡改签名的源文件 C5S11

- 具有保密特性的RSA签名方案

	> 发方：M,C=$D_{skp}(E_{rko}(M))$
	>
	> 传输：M+C
	>
	> 收方：$D_{rkp}(E_{sko}(C))$

	- 工作原理 C5S13
	
		<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/rsa2.png"/>
	
	- 具有消息鉴别、数字签名功能

- 数字签名标准DSS

	- 初始化

		- p：大素数, 2L-1 <p< 2L , 512≦L≦1024；
		- q：(p-1)的素因子，且2159<q<2160，即字长160b
		- g：g≡h(p-1)/q mod p，且1<h<(p-1)，h(p-1)/q mod p >1
		- x：选择用户私钥，0<x<q
		- y：计算用户公钥，y≡gx mod p
		- p, q, g为全局公钥， y为发送方公钥，x为私钥。

	- 签名过程

		<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/dss.png"/>

		- 用户选择秘密随机数k，0<k<q
		- 计算：H(m)
		- 计算：r=(gk mod p)mod q（r与消息是没有关系）
		- 计算：s=[k-1(H(m)+xr)] mod q （H(M)建议为SHA算法）
		- 签名：Sigk(m)=(r, s)，将m和(r, s)送给对方(r||s被称为签名）

- DSS签名算法--DSA C5S15

	<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/dsa.png"/>

- RSA 🆚 DSA对比

	| RSA              | DSA                            |
	| ---------------- | ------------------------------ |
	| 可用于加密       | 不可用于加密                   |
	| 签名验证速度较快 | 签名验证速度慢，不适合联机应用 |
	| 实施标准         | 是NSA开发的                    |

#### 3. 其他签名模式

- 不可否认签名
	- 签名接受者滥用签名验证权 -> 要求与签名者合作验证签名
	- 应用：软件拷贝保护、知识产权保护
- 盲签名
	- 特点：签名者不知道签名内容、不可跟踪签名信息
	- 应用：电子货币、电子投票、匿名支付
	- 易被恶意者滥用，改进公平盲签名（匿名跟踪）
- 群签名
	- 群成员代表签名
	- 应用：公开招投标
- 代理签名
	- 某人授权其代理进行的签名（签名密钥不交给代理人）
	- 特性：不可区分性、不可伪造性、代理签名的差异、可证实性、可识别性、不可抵赖性
- 指定证实人签名
	- 一个机构中，指定一个人负责证实所有人的签名
	- 任何成员签的文件具有不可否认性、证实工作均由指定人完成
	- 有助于防止签名失效

# Chap5.2 信息隐藏

#### 1. 信息隐藏概述

- 数字化产品的保护问题

	> 数字化产品本身的可复制和广泛传播特性使得个人或团体有可能在没有得到原作者授权的情况下进行非法拷贝和传播

	- 加密、签名不能完全解决数字化产品的保护
		- 加密、签名后的数字化产品失去易理解性，影响了传播和使用
		- 加密一旦被破解，失去了保护意义
	- 解决方案：基于信息隐藏的数字水印技术

- 信息隐藏

	- 内涵：指将秘密信息秘密的隐藏于另一非机密的文件之中（数字媒体如图像、声音、视频etc）

	- 目的：隐藏信息，不引起攻击者的注意和重视，减少被侵犯的可能

	- 分类

		- 隐秘信道

			> 不为外人知道，只为通信双方知道的通信信道

		- 伪装术

			> 进行秘密通信的技术的总称，将秘密信息隐藏到其他不易引起怀疑的公开数据中

		- 匿名通信

			> 设法隐藏消息的来源去处，但根据不同情况决定发送双方是否匿名

		- 数字水印

			> 永久镶嵌在其他数据中具有鉴别性的数字信号或模式（不明显的，但可以被检验是否存在），且并不影响宿主数据的可用性
			>
			> 水印一般与密码相关，只有知道密码才能进行正确的水印

#### 2. 数字水印

- 特性

	- 保真度：水印作品前后在感知上的相似度
	- 有效荷载：水印信息中包含的有效比特数
	- 提取水印时需要的辅助信息类型
	- 可证明性：为信息产品的版权归属提供完全可靠的证据
	- 鲁棒性：水印能够承受大量的物理和几何失真，包括有意的（恶意攻击）和无意的（图像压缩、滤波）
	- 透明性：水印对于人和机器是不可见的
	- 安全性：即使知道水印的存在，攻击方也很难抹去水印，但如果攻击方企图抹掉水印，载体的使用价值会受到极大的破坏
	- 嵌入有效性：嵌入后能立即被检测出来的概率
	- 虚警率：在不含水印的作品中检测出水印的概率

- 应用

	<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/dwapp.png"/>

- 分类

	- 按可见与否：可见水印和不可见水印
	- 按水印添加方式：空域水印与频域水印
	- 按水印检测方式：水印提取法和水印检测法

- 数字水印方案

	<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/dw.png"/>

	<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/dw2.png"/>

	- 水印生成
	- 水印嵌入
	- 水印的提取、检测

- 数字水印技术

	> 以不可感知的方式在数字作品中嵌入信息的技术

#### 3. 空域水印技术

- 含义：较早的数字水印算法是空间域上的，空域水印处理使用各种各样的方法直接修改图像的像素，将数字水印直接加载在数据上

- 具体方法

	<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/algo.png"/>

	- 最低有效位方法 Least Significant Bit -- LSB

		⚠️ 如果剪去宿主中间部分，水印中间部分也会消失 -> 解决：嵌入前对水印进行随机排列，提取时在进行逆排列

		- 图像的数字化表示

			> 对图像，可以根据像素的比特位来进行图像分解，将其分解为不同平面

			- 灰度图像中，每个像素通常为8位
			- 真彩色图像中，每个像素为24比特，其中RGB三色各为8位

		- 不同平面的作用

			- 低位所代表的能量很少，改变低位对图像的质量没有太大的影响
			- LSB利用这一点在图像低位隐藏入水印信息

		- 特点

			- 水印易被破坏（可简单删除图像低位数据）
			- LSB方法实现简单、隐藏量大

	- Patchwork方法及纹理块映射编码方案（基于统计）

		- 基本思想	
			- 嵌入过程：将图像的每个像素随体标记为A类或B类，在密钥k的作用，选出n个像素对$(a_i,b_i)$，按照公式$a'=a_i+1;b'=b_i-1$修改像素对的值
			- 检验或提取过程：在密钥k的作用，选出n个像素对，按照$S=\sum_{i=1}^{n}{a'-b'}$计算，如果载体包含水印，这个和为2n，否则近似于0
		- 特点
			- 隐蔽性好
			- 对JPEG压缩、FIR滤波以及图像剪切操作有一定的抵抗力
			- 嵌入的信息量有限
			- 可对图像进行分块，然后对不同块进行水印嵌入

	- 文档结构微调方法

	- 通信模型

		- 标准通信模型： 输入-> 信道编码器-> 信道噪声-> 信道解码器-> 输出
		- 高斯信道：噪声信号n的元素之间互相独立，且每个元素$n_i$均服从均值为0的正态分布
		- 安全传输
			- 密码系统：不能隐瞒信息的存在性；不能防止被干扰或删除
			- 扩频通信：将信号调制扩展到原始信道的带宽，从而实现抗干扰和保密功能

#### 4. 变换域水印

- 主要特点
	- 在JEPG等有损压缩编码下有较好的鲁棒性
	- 原始图像与水印图像具有相同的大小
	- 嵌入大量水印信息而不引起可察的质量下降
- 基本过程
	- 对原始图像做变换
	- 在变换域嵌入水印
	- 做逆变换

- 主要方法
	- 离散余弦变换(DCT)
		- 嵌入过程：计算图像的离散余弦变换，将水印叠加到DCT域中幅值较大的前k系数上，通常为图像的高频分量
		- 检验过程：将原始图像和水印图像做离散余弦变换后根据函数h得到水印w
		- ⚠️：DCT水印算法改变的是中频系数，原因是人视觉对低频系数的改变敏感，高频数据容易被压缩去掉
	- 离散小波变换（DWT）
	- 傅氏变换（DFT或FFT）
	- 傅立叶－梅林（Fourie-Mellin）变换
	- 哈达马变换（Hadamard transform）

# Chap6 密钥管理

#### 1. 概述

- 密钥：参与、控制数据安全变换的可变参数

- 必要性

	- 所有数据安全技术的安全性都依赖于密钥的安全性
	- 密钥的安全性体现在以下方面
		- 本身的安全性
		- 被安全保管
		- 被安全使用
	- 密钥有多种形式和不同用途，每种密钥的安全性需求是不同的

- 生存期

	> 密钥从产生到销毁的生存时间

	- 密钥不能无限使用 -> 原因 C6S3

#### 2. 密钥管理 = 密钥管理技术 + 密钥管理制度

> 指在一种安全策略指导下，密钥的产生、**存储、分配、**删除、归档及应用
>
> 处理密钥自产生到最终销毁的整个过程中的有关问题，确保密钥的安全性

- 目的：维持系统中各实体之间的密钥关系，以抗击各种可能的威胁：泄露、真实性丧失、未经授权使用

- 核心内容

	- 密钥生成管理

		😊密钥生成技术

		- 好的密钥
			- 保密强度(承受攻击强度)相当的对称密加密码与公开密钥长度
			- 应当有良好的随机性和密码特性（避免弱密钥【易受字典攻击】的出现：容易被猜中的、影响加密安全的，如DES算法中存在的）
		- 密钥产生
			- 必须在安全环境中，防止非授权访问
			- 产生模式
				- 有边界产生：由中心集中生产，即边界生产
				- 无边界产生：由个人分散生产
			- 产生形式：自动、手动
			- 产生方法
				- 随机数、伪随机数、准随机数
				- 基于DES的OFB(输出反馈)产生方
				- 基于ANSI X9.17的产生方法

	- 密钥存储管理

		㊙️ 密钥存储技术

		- 整体保存：一个密钥作为一个整体被保存在某个地方

		- 分散保存：一个密钥被分成若干个部分保存在不同地方

		- eg. Shamir(t,n)门限方案 S31

			<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/shamir1.png"/>

			<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/shamir2.png"/>

	- 密钥建立管理

		🧐 密钥建立技术：协商 + 分配

		分类

		- 按建立方式

			- 密钥协商协议：系统内一个成员选择密钥,然后将其安全传给其他成员

				- eg. D-H协议 S12

					<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/dh.png"/>

			- 密钥分配协议：系统内一个成员选择密钥,然后将其安全传给其他成员

				- eg. 基于对称密码体制的对称密钥分配

					①通信方+物理方法：密钥由A选取并通过物理手段发送给B或协商产生；

					 ② 通信方+保密信道：若A、B事先已有一密钥，则其中一方选取新密钥后，用已有的密钥加密新密钥并发送给另一方；

					 ③ 第三方+物理方法：密钥由第三方选取并通过物理手段发送给A和B；

					 ④ 第三方+保密信道：**KDC模式**，若A、B与第三方C分别有一保密信道，则C为A、B选取密钥后，分别在两个保密信道上发送给A、B。 S16

					- ​	A向KDC发请求，要求得到一个用来保护她和B间对话的密钥ks
					- KDC用一个经过Ka加密的报文作为响应
					- A转发KDC消息给B
					- B使用会话密钥ks发送一个密文给A（鉴别功能

					- A也使用Ks响应一个f(N2)（鉴别功能

				- Eg. 基于公开密码体制的对称密钥分配

					- 本质：不需要机密性，但需要完整性（指明公钥确实是某个人的）

					- 公钥证书：用户通过公钥整数交换公钥而无需与管理机构联系 S19

						<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/certi.png"/>

		- 按密码类别

			- 对称密钥的分配技术
			- 公开密钥的分配技术

	- 密钥使用管理

	- 密钥备份/恢复管理

	- 密钥更新管理

	- 密钥撤销/存档/销毁

#### 3. BB84量子密钥分发协议

> 量子隐态传输（纠缠原理） +  量子密钥分配（叠加原理）

- 量子通信

	> 量子：状态是叠加的、纠缠的EPR（多个量子系统间存在非定域、非经典的强关联）
	>
	> 量子通信：量子通信是指利用**量子纠缠**效应进行信息传递的一种新型的通讯方式，具有高效率和绝对安全等特点，是目前量子物理和信息科学的研究热点

	- 与经典信息的根本区别：经典粒子智能处于0、1的一个态上，二微观粒子允许同时处在0、1两个态上

- 量子隐态传输

	- 纠缠态

		<img src="https://raw.githubusercontent.com/FionaChan01/FionaChan01.github.io/master/post_image/post_informationsecurity/quan.png"/>

		A、B光子的状态无法确定，但可以测量获得A的量子态，也可推断出B的状态

	- BB84量子密钥分发协议 S26
		- 能否发生窃听：计算错误率是否增大
		- 测量塌缩理论
			- 如果测量基与编码基是完全相同的，量子态不被破坏，则可以完全恢复信息
			- 若不一致，不能完全恢复信息
